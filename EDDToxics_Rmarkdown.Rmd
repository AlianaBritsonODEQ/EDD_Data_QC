---
params:
  org: NA
  startdate: NA
  enddate: NA
  qls: NA
  methods: NA
  diff: NA
  reject: NA
  data: NA
  qlcom: NA
  mcom: NA
  dfcom: NA
  rejcom: NA
output: pdf_document
header-includes:
  \usepackage{booktabs}
  \usepackage{float}
---

#`r paste("EDD Toxics Report for: ",params$org)` 
##`r paste("Sampling event Dates:",params$startdate," to ",params$enddate)` 
## Report by: Aliana Britson 

```{r setup-packages-functions, include=FALSE}
library(knitr)

#including kableExtra seems to mess with booktabs and float latex packages, so compile fails on second pdf. 
#included packages in YAML header to fix problem
library(kableExtra)
library(tinytex)

```
### Pollutants Analyzed
Table 1 contains a list of pollutants analyzed and submitted by the permittee. Please see individual permit for list of required polluants and the monitoring schedule. 
``` {r echo=FALSE}
#get the unique names of the pollutants
dat<-namefrac(params$data)
names<-count(dat,Char_Name)
#sort them alphabetially
names<-sort(names$Char_Name)

#will likely need to split into a few tables, a list is overwhelming if permittee does full suite of volatiles and semi-volatiles

kable(names, format='latex', caption="List of Analyzed Pollutants", booktabs=TRUE) %>%
 kable_styling(latex_option="HOLD_position")
```


### Quantitation Limits 
A quantitation limit (QL) is the lowest amount of a pollutant that can be reliably measured. Permittees are required to use the most sensitive analytical test method, as specified in 40 CFR 122.44(i)(1)(iv). Established QL requirements were adopted in 2007 for NPDES permits and updated in 2015 by DEQ LEAD. 

Table 2 includes a list of pollutants for which the provided QLs are not sufficiently sensitive. This table uses the current established QLs from DEQ LEAD that were updated in 2015. In some cases, permitees have the option of providing matrix or sample specific QLs, please see the individual permit for any permittee-specific QLs. 

``` {r echo=FALSE}
qlc<-params$qls
qlc<-subset(qlc,select=c("Char_Name","CASNumber","act_id","Result","MRLValue","MRLUnit","QL","QL_Unit","Result_Comment"))
#rename columns
names(qlc)<-c("Pollutant","CAS Number","Activity ID","Result","Submitted QL","Unit","Established QL","Unit","Result Comment")

kable(qlc, format='latex', caption="Insufficient Quantitation Limits",booktabs=TRUE, row.names=FALSE) %>%
  kable_styling(latex_options=c("HOLD_position","scale_down"))


```

 **Water Quality Data Steward Comments:** `r params$qlcom`

### Methods 
 Permittees are required to use methods approved under 40 CFR 136. There are some pollutants that have no approved methods under 40 CFR 136. In some cases, permittees may obtain approval to perform different methods for specific pollutants through EPA. These instances are permittee-specific and should be contained within the permit. Please see the individual permit. 

Table 3 inlcludes a list of pollutants that were not analyzed using CFR methods
``` {r echo=FALSE}
kable(params$methods, format='latex', caption="Pollutants analyzed using non-CFR methods",booktabs=TRUE, row.names=FALSE) %>%
  kable_styling(latex_option="HOLD_position","scale_down")
```


**Water Quality Data Steward Comments:** `r params$mcom`


### Total Recoverable vs Dissolved
In the analysis of metals, the dissolved fraction of the pollutant should be less than the total recoverable fraction of the pollutant. However, there are some cases where sample contamination from an outside source or method uncertainty causes the dissolved fraction to be larger than the total recoverable fraction. Table 4 contains metals analysis where the dissolved fraction was larger than the total recoverable fraction. 
``` {r echo=FALSE}
kable(params$diff, format='latex', caption="Metals with dissolved fraction larger than total recoverable fraction", booktabs=TRUE, row.names=FALSE) %>%
  kable_styling(latex_option="HOLD_position","scale_down")
```


**Water Quality Data Steward Comments:** `r params$dfcom`

### Rejected Data
In some cases, data does not pass quality control analysis. 

Table 5 contains data that did not pass quality control checks. This data may still be usable for permitting purposes, but must be used with caution.

``` {r echo=FALSE}
kable(params$reject,format='latex', caption="Rejected Data",booktabs=TRUE, row.names=FALSE) %>%
  kable_styling(latex_option="HOLD_position","scale_down")
```


**Water Quality Data Steward Comments:** `r params$rejcom`
